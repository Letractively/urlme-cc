<!DOCTYPE html> 
<html> 
	<head> 
	<title>My Page</title> 
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css" />
	<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
    <script src="Scripts/codejkjk/codejkjk.js"></script>
    <script src="Scripts/codejkjk/codejkjk.movies.Defaults.js"></script>
    <!--<script src="Scripts/codejkjk/codejkjk.movies.Mobile.js"></script>-->
    <script src="Scripts/codejkjk/codejkjk.movies.RottenTomatoes.js"></script>
    <script src="Scripts/codejkjk/codejkjk.movies.Flixster.js"></script>
    <script src="Scripts/codejkjk/codejkjk.movies.IMDB.js"></script>
    <script src="Scripts/Plugins/jsrender.js"></script>
    <script src="Externals/local-cache/local-cache.js"></script>
    <link href="content/mobile.css" rel="stylesheet" type="text/css" />
</head> 
<body> 

<!--** TOP BOX OFFICE PAGE **-->
<div data-role="page" id="topBoxOffice">
	<div data-role="header">
        <input type="search" value="Search..." />
        <div data-role="navbar">
            <ul>
                <li><a href="#topBoxOffice" class="ui-btn-active">Top Box Office</a></li>
                <li><a href="#showtimes">Showtimes</a></li>
                <li><a href="#comingSoon">Coming Soon</a></li>
            </ul>
        </div>
	</div>

    <div data-role="content">	
        box office
        <ul data-role="listview" data-theme="c" id="movieList">
        </ul>
	</div>
</div>

<!--** SHOWTIMES PAGE **-->
<div data-role="page" id="showtimes">
	<div data-role="header">
        <input type="search" value="Search..." />
        <div data-role="navbar">
            <ul>
                <li><a href="#topBoxOffice">Top Box Office</a></li>
                <li><a href="#showtimes" class="ui-btn-active">Showtimes</a></li>
                <li><a href="#comingSoon">Coming Soon</a></li>
            </ul>
        </div>
	</div>

    <div data-role="content"></div>
</div>

<!--** COMING SOON PAGE **-->
<div data-role="page" id="comingSoon">
	<div data-role="header">
        <input type="search" value="Search..." />
        <div data-role="navbar">
            <ul>
                <li><a href="#topBoxOffice">Top Box Office</a></li>
                <li><a href="#showtimes">Showtimes</a></li>
                <li><a href="#comingSoon" class="ui-btn-active">Coming Soon</a></li>
            </ul>
        </div>
	</div>

    <div data-role="content"></div>
</div>

<script>
    $(document).bind("pagebeforechange", function (e, data) {
        // handle changepage where the caller is asking us to load a page by url
        if (typeof data.toPage === "string") {
            var url = $.mobile.path.parseUrl(data.toPage);
            var hash = url.hash;
            console.log('load hash, ' + hash);

//            var pageSelector = hash.replace(/\?.*$/, "");
//            var page = $(pageSelector);
//            data.options.dataUrl = url.href;
//            $.mobile.changePage(page, data.options);

            e.preventDefault();

            // codejkjk.movies.Mobile.LoadUrl(pathName);

            // e.preventDefault(); // is this a good thing?

            //            var u = $.mobile.path.parseUrl(data.toPage), re = /^#movie-details/;
            //            if (u.hash.search(re) !== -1) {

            //            }
        } else {
            console.log('load root');
        }
    });
</script>

<script id="movieTemplate" type="text/x-jquery-tmpl">
    {{#if alternate_ids}}
    <li><a href="#">
        <img src="{{=posters.thumbnail}}" />
        <h3>{{=title}}<span class="rating">{{=mpaa_rating}}</span></h3>
        {{#if $ctx.IsReleased(release_dates.theater)}}
            <p class="ratings">
                <span class='{{=$ctx.GetCriticsClass(ratings.critics_rating)}} rottenTomato'>{{=ratings.critics_score}}<sup>%</sup></span>
                <span class='{{=$ctx.GetAudienceClass(ratings.audience_rating)}} rottenTomato'>{{=ratings.audience_score}}<sup>%</sup></span>
                <span data-imdbmovieid="{{=alternate_ids.imdb}}" class='imdb imdbNotSet'></span>
            </p>
        {{else}}
            <p class="releaseDate">{{=release_dates.theater}}</p>
        {{/if}}
    </a></li>
    {{/if}}
</script>

</body>
</html>
