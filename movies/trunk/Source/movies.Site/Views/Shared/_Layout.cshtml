@model movies.Site.ViewModels.ViewModelBase

<!DOCTYPE html>
<html xmlns:fb="http://ogp.me/ns/fb#">
<head>
    <title>@ViewBag.Title</title>
    @{ Html.RenderPartial("OpenGraphTags", Model); }
    <link rel="icon" href="~/content/favicon.jpg" />
    <script type="text/javascript">
        var apiBaseUrl = '@Url.Content("~/api/")';
    </script>
    <script src="@System.Web.Optimization.BundleTable.Bundles.ResolveBundleUrl("~/desktop-js-bundle")" type="text/javascript"></script>
    <link href="@System.Web.Optimization.BundleTable.Bundles.ResolveBundleUrl("~/desktop-css-bundle")" rel="stylesheet" />
    <script src="~/Scripts/Plugins/iPhoneStyleCheckboxes/iphone-style-checkboxes.js" type="text/javascript"></script>
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?libraries=places&sensor=false"></script>
    <script type="text/javascript">
        ZeroClipboard.setMoviePath('@Url.Content("~/scripts/plugins/zeroclipboard/zeroclipboard.swf")');
    </script>
    @RenderSection("ExtraHeadContent", required: false)

    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-29837388-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

        // http://gosquared.com, pretty sweet.
        var GoSquared = {};
        GoSquared.acct = "GSN-569535-T";
        (function(w){
            function gs(){
                w._gstc_lt = +new Date;
                var d = document, g = d.createElement("script");
                g.type = "text/javascript";
                g.src = "//d1l6p2sc9645hc.cloudfront.net/tracker.js";
                var s = d.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(g, s);
            }
            w.addEventListener ?
              w.addEventListener("load", gs, false) :
              w.attachEvent("onload", gs);
        })(window);
    </script>

    <script type="text/javascript">
        var uvOptions = {};
        (function () {
            var uv = document.createElement('script'); uv.type = 'text/javascript'; uv.async = true;
            uv.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'widget.uservoice.com/OMXCrkNwPgQu9xJ4X1IsA.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(uv, s);
        })();
    </script>
</head>

<body>
<div id="fb-root"></div>
<script>
    window.fbAsyncInit = function () {
        FB.init({
            appId: '118119081645720', // App ID
            status: true, // check login status
            cookie: true, // enable cookies to allow the server to access the session
            xfbml: true  // parse XFBML
        });

        // add'l init code goes here
        // get authorized here, https://graph.facebook.com/oauth/authorize?client_id=118119081645720&redirect_uri=http://seeitornot.co/redirect
        @if (Request.Url.ToString().ToLower().Contains("localhost")) {
            <text>codejkjk.movies.desktop.adminize(6207283);</text>
        }
        FB.getLoginStatus(function (response) {
            if (response.status === 'connected') {
                codejkjk.movies.desktop.adminize(response.authResponse.userID);
            }
        });
    };

    // Load the SDK Asynchronously
    (function (d) {
        var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
        if (d.getElementById(id)) { return; }
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        ref.parentNode.insertBefore(js, ref);
    } (document));
</script>

    <header class="group orangeDiag">
        <div id="headerContent" class="group">
            <a id="logo" class="logo noPush group" href="~/"></a>
            <div id="fbLikeContainer"><div class="fb-like" data-href="http://www.facebook.com/SeeItOrNot" data-send="false" data-layout="button_count" data-width="75" data-show-faces="false" data-font="arial"></div></div>
            <div id="headerAd">
                <script type="text/javascript"><!--
                    google_ad_client = "ca-pub-1571990684638145";
                    /* Banner - 468x60 */
                    google_ad_slot = "6761138015";
                    google_ad_width = 468;
                    google_ad_height = 60;
                //-->
                </script>
                <script type="text/javascript"
                src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
                </script>
            </div>
        </div>
    </header>
    @RenderSection("Nav", required: true)
    @RenderBody()

    <script id="favoriteTheaterListTemplate" type="text/x-jquery-tmpl">
        {{#if $ctx.IsCurrentTheater(id) }}
            <a class="selected glowing" href="#" data-theaterid="{{=id}}">
        {{else}}
            <a href="#" data-theaterid="{{=id}}">
        {{/if}}
            <div class="favoriteLink lit"></div>
            <div class="theaterName">{{=$ctx.Snippet(name, 30)!}}</div>
        </a>
    </script>
    <script id="theaterListTemplate" type="text/x-jquery-tmpl">
        {{#if $ctx.IsCurrentTheater(id) }}
            <a class="selected glowing" href="#" data-theaterid="{{=id}}">
        {{else}}
            <a href="#" data-theaterid="{{=id}}">
        {{/if}}
            <div class="favoriteLink default"></div>
            <div class="theaterName">{{=$ctx.Snippet(name, 30)!}}</div>
        </a>
    </script>
    <script id="currentTheaterTemplate" type="text/x-jquery-tmpl">
        {{#if $ctx.IsCurrentTheater(id) }}
            <div class="theater selected rounded glowing group" data-theaterid="{{=id}}">
        {{else}}
            <div class="theater rounded group" data-theaterid="{{=id}}">
        {{/if}}    
            <div class="theaterNameAndFavorite">
                <h1>{{=name}}</h1><a class="favoriteLink {{=$ctx.GetFavoriteLinkClass(id)}}" href="#"></a>
            </div>
            <p class="address">{{=address}}</p>
            <div class="showtimeDays"></div>
            <div class="showHiddenMoviesLinkContainer {{#if numHiddenMovies}} {{else}} hidden {{/if}}"><a href="#" class="showHiddenMoviesLink">Show hidden movies (<span class="numHiddenMovies">{{=numHiddenMovies}}</span>)</a></div>
            {{#each movies}}
                <div class="movie rounded glowing gradient {{=movieClass}} group" data-rtmovieid="{{=id}}">
                    <a href="/{{=movieSlug}}" class="group">                    
                        <img src="{{=profileImageUrl}}" />
                        <div class="details">
                            <p class="ratings smaller">
                                <span data-rtratingtitle="{{=audienceRating}}" class="rottenTomato icon"></span><span class="rt text">{{=audienceScore}}</span>
                            </p>
                            <p>{{=duration}}</p> 
                            <span class='mpaaRating'>{{=mpaaRating}}</span>
                            <p class="showtimes">{{=showtimesHtml!}}</p>
                        </div>
                    </a>
                    <div class="actions">
                        <a class="button hideMovieLink" data-theatermovie="{{=$parent.parent.data.id}}-{{=id}}"><span class="x">&#10006;</span>Hide</a>
                    </div>
                </div>
            {{/each}}
        </div>
    </script>

@* crazyegg.com stats *@
<script type="text/javascript">
    setTimeout(function () {
        var a = document.createElement("script");
        var b = document.getElementsByTagName("script")[0];
        a.src = document.location.protocol + "//dnn506yrbagrg.cloudfront.net/pages/scripts/0014/2631.js?" + Math.floor(new Date().getTime() / 3600000);
        a.async = true; a.type = "text/javascript"; b.parentNode.insertBefore(a, b)
    }, 1);
</script>

</body>
</html>
